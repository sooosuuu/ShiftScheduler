# AIシフト作成機 (RustShift) 取扱説明書

## 1. 概要

本ソフトウェアは、機械学習（遺伝的アルゴリズム）と高速言語Rustを用いて、複雑な条件を満たすシフト表を自動生成するツールです。
スタッフの希望休、勤務間隔（インターバル）、役職ごとの必要人数などを考慮し、公平で無理のないシフトを数秒〜数十秒で作成します。

## 2. 必要なファイル構成

本ソフトを使用する際は、以下のファイルが同じフォルダ（場所）にあることを確認してください。

* gui_app.exe （ソフト本体）
* config.json （設定ファイル）

---

## 3. 基本的な使い方

### Step 0: 設定の確認（最初だけ）

config.json をメモ帳などで開き、スタッフの基本構成を設定してください。
※人数が変わった場合は、ここを書き換えるだけで対応できます。

```
{
  "population_size": 50000,   // 計算の精密さ（基本はこのままでOK）
  "generations": 1000,        // 計算回数
  "default_roles": {
    "Chief": 5,    // チーフの人数
    "Leader": 2,   // リーダーの人数
    "Staff": 3,    // スタッフの人数
    "Assist": 10   // アシストの人数
  }
}
```

### Step 1: 入力用テンプレートの作成

1. gui_app.exe をダブルクリックして起動します。
2. 「テンプレート作成」ボタンを押します。
3. 作成したいシフトの「年」と「月」を入力します（例：2025年 12月）。
4. フォルダ内に staff_request.xlsx が作成されます。

### Step 2: 希望シフトの入力

作成された Excelファイル（staff_request.xlsx）を開き、スタッフの希望を入力します。

* 名前・役職: 自由に変更可能です。
* シフト希望: 日付のセルをクリックすると「▼」マークが出ます。リストから選択してください。

  * NG: 休み希望
  * 朝: 朝番（早番）のみ可
  * 夜: 夜番（遅番）のみ可
  * 空欄: いつでも可

入力が終わったら、上書き保存してExcelを閉じてください。

### Step 3: シフト自動生成

1. アプリ画面の「シフト生成開始」ボタンを押します。
2. 計算が始まります（通常10秒〜30秒程度）。
3. 完了すると、結果が記載された shift_result.xlsx が自動で開きます。

---

## 4. シフト作成のルール（AIの判断基準）

本AIは、以下のルールを厳守するようにプログラムされています。

### ① 勤務体制（お店のルール）

* 必要人数: 毎日、朝5名以上・夜5名以上 が出勤します。
* 役職バランス: 毎日、管理職（ChiefまたはLeader）が必ず 2名以上 配置されます。

### ② 従業員の健康管理（ホワイトなシフト）

* 連勤制限: 6連勤以上 は禁止されています（最大5連勤まで）。
* インターバル: 夜勤の翌日は「休み」または「夜勤」になります。（夜勤→朝番 という無理なシフトは禁止されています）。
  * ※夜勤のあと朝番に入る場合は、必ず2日間の間隔が空けられます。

### ③ 公平性（勤務日数）

* Assist: 月間 10日 前後
* その他: 月間 21日 前後（週休2日ペース）
  * ※希望休の数によって多少前後することがあります。

---

## 5. 診断レポート機能について

シフト生成完了時、アプリの画面下に「診断レポート」が表示されます。

* 「✨違反箇所ゼロ！完璧です」と出た場合：
    すべてのルールと希望を守った完璧なシフトです。そのまま採用してください。

* 「⚠️警告」が出た場合：
    （例：⚠️ [人手不足] 12/1(水): 朝4人 など）
    条件が厳しすぎて、AIが解決策を見つけられなかった箇所です。
    Excel（shift_result.xlsx）を確認し、必要に応じて手動で微調整を行ってください。

---

## 6. トラブルシューティング

Q. アプリが起動しない / すぐ落ちる
A. config.json が同じフォルダにあるか確認してください。また、JSONファイルの記述（カンマ抜けなど）が正しいか確認してください。

Q. 「入力ファイルが見つかりません」と出る
A. Step 1でテンプレートを作成するか、staff_request.xlsx という名前のExcelファイルが同じフォルダにあることを確認してください。

Q. 満点（100点）のシフトが出ない
A. 希望休（NG）が多すぎるか、特定の日（土日など）に休み希望が集中している可能性があります。Excelで希望休を少し減らして再実行してみてください。

Q. 計算時間を短くしたい / もっと粘らせたい
A. config.json の "population_size" を変更してください。
   * 速くしたい: 数値を減らす（例: 30000）。※精度は落ちます
   * 精度を上げたい: 数値を増やす（例: 100000）。※時間はかかります